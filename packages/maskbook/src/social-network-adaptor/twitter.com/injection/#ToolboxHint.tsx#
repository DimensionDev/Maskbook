import { MutationObserverWatcher } from '@dimensiondev/holoflows-kit'
import { ToolboxHint } from '../../../components/InjectedComponents/ToolboxHint'
import { createReactRootShadowed } from '../../../utils/shadow-root/renderInShadowRoot'
import { toolBoxInSideBarSelector } from '../utils/selector'
import { startWatch } from '../../../utils/watcher'
import { makeStyles } from '@material-ui/core'

export function injectToolboxHintAtTwitter(signal: AbortSignal) {
    const watcher = new MutationObserverWatcher(toolBoxInSideBarSelector())
    startWatch(watcher, signal)
    createReactRootShadowed(watcher.firstDOMProxy.afterShadow, { signal }).render(<ToolboxHintAtTwitter />)
}

<<<<<<< HEAD
        [theme.breakpoints.down('lg')]: {
            transform: 'translateX(0px)',
=======
const useStyles = makeStyles((theme) =>
    createStyles<string, { color?: string }>({
        wrapper: {
            paddingTop: 4,
            paddingBottom: 4,
            cursor: 'pointer',
            [theme.breakpoints.down('lg')]: {
                transform: 'translateX(0px)',
            },
>>>>>>> be94fddfe (fix: the color of primary text is dimmer than the original text color (#2854))
        },
    },
    menuItem: {
        paddingTop: theme.spacing(2),
        paddingBottom: theme.spacing(2),
    },
    title: {
        color: theme.palette.mode === 'dark' ? 'rgb(216, 216, 216)' : 'rgb(15, 20, 25)',
    },
    text: {
        marginLeft: 12,
        fontSize: 15,
        color: theme.palette.mode === 'dark' ? 'rgb(216, 216, 216)' : 'rgb(15, 20, 25)',
        paddingRight: theme.spacing(2),
    },
    icon: {
        color: theme.palette.mode === 'dark' ? 'rgb(216, 216, 216)' : 'rgb(15, 20, 25)',
    },
    button: {
        '&:hover': {
            backgroundColor: theme.palette.mode === 'dark' ? 'rgb(7, 15, 25)' : 'rgb(233, 246, 253)',
        },
<<<<<<< HEAD
        '&:active': {
            backgroundColor: theme.palette.mode === 'dark' ? 'rgb(13, 29, 48)' : 'rgb(212,237,252)',
        },
    },
}))
=======
        title: {
            color: (props) => (props.color ? props.color : 'rgb(217, 217, 217)'),
        },
        text: {
            marginLeft: 12,
            fontSize: 15,
            color: theme.palette.mode === 'dark' ? 'rgb(216, 216, 216)' : 'rgb(15, 20, 25)',
            paddingRight: theme.spacing(2),
        },
        icon: {
            color: (props) => (props.color ? props.color : 'rgb(217, 217, 217)'),
        },
        button: {
            '&:hover': {
                backgroundColor: theme.palette.mode === 'dark' ? 'rgb(7, 15, 25)' : 'rgb(233, 246, 253)',
            },
            '&:active': {
                backgroundColor: theme.palette.mode === 'dark' ? 'rgb(13, 29, 48)' : 'rgb(212,237,252)',
            },
        },
    }),
)
>>>>>>> be94fddfe (fix: the color of primary text is dimmer than the original text color (#2854))

function GetColor() {
    const ele = document
        .getElementsByTagName('header')[0]
        .getElementsByTagName('nav')[0]
        .getElementsByTagName('a')[1]
        .getElementsByTagName('div')[0]
        .getElementsByTagName('div')[1]
    const style = window.getComputedStyle(ele, null)
    return style.color
}
function ToolboxHintAtTwitter() {
    const color = GetColor()
    const classes = useStyles({ color })

    // Todo: add click handler
    return (
        <ToolboxHint
            classes={{
                wrapper: classes.wrapper,
                menuItem: classes.menuItem,
                title: classes.title,
                text: classes.text,
                button: classes.button,
                icon: classes.icon,
            }}
        />
    )
}
